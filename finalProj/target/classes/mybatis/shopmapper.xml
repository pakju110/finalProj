<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="shopmapper">

	<!-- <select id="selectList2" resultType="shopVo" parameterType="shopVo">
		select * from shop where type = #{type}
	</select> -->
	
	<select id="selectList" resultType="alishop">
   		select * from shop where grade = 'r'
   </select>
      <select id="selectwList" resultType="alishop">
   		select * from shop where grade = 'w'
   </select>
   <select id="wList" resultType="alishop">
   		select * from shop where grade = 'w'
   </select>
   <select id="cateList" resultType="alishop" parameterType="String">
   		select * from shop where type = #{type}
   </select>
   
      <select id="selectDetail" resultType="alishop" parameterType="alishop">
   		select * from shop where rest_id = #{rest_id}
   </select>
   <select id="shopDetail" resultType="alishop" parameterType="String">
   		select * from shop where rest_id = #{rest_id}
   </select>
   
    <delete id="delete" parameterType="alishop">
   		delete from shop where  rest_id = #{ rest_id}
   </delete>
   
   <update id="modify" parameterType="alishop">
   		update shop set 
   		opentime = #{opentime}, closetime = #{closetime},
   		 contents = #{contents}, sysfile = '1', orifile = '이창준이 해주기로함'
   		 where rest_id = #{rest_id}
   </update>
   
   
   
   <insert id="insertOne" parameterType="alishop">
<!-- 	   <selectKey keyProperty="id" order="BEFORE" resultType="java.lang.Integer">
	   		select max(id)+1 from shop
	   </selectKey> -->
   	insert into shop 
   	(rest_id,  brand, name, type, star, addr,  opentime, closetime, contents, tel, orifile, sysfile,grade)
   	values
   	(#{rest_id}, #{brand}, #{name}, #{type}, 0, #{addr}, #{opentime}, #{closetime}, #{contents}, #{tel}, #{orifile}, #{sysfile},#{grade})
   
   </insert>
   
   <select id="idPwChk" resultType="alishop" parameterType="alishop">
   		select * from shop where rest_id = #{ rest_id} 
   </select>
   
   
   <!-- review -->
   
   <insert id="reviewinsert" parameterType="alireview">
   	insert into review 
   	(orderno, rest_id, user_id, title, contents, orifile, sysfile, star, reg_date)
   	values
   	(#{orderno}, #{rest_id}, #{user_id}, #{title}, #{contents}, #{orifile,jdbcType=VARCHAR} , #{sysfile,jdbcType=VARCHAR} , #{star}, sysdate)
   
   </insert>
   <update id="reviewshopmodify" parameterType="alishop">
   		update shop set 
   		star = #{star}
   		where id = #{id}
   </update>
   
   <select id="reviewcheck" resultType="alireview" parameterType="Integer">
   		select * from review where orderno = #{orderno}
   </select>
   <select id="reviewcheck2" resultType="alireview" parameterType="alireview">
   		select * from review where orderno = #{orderno} and user_id = #{user_id} 
   </select>
   <delete id="reviedelete"  parameterType="Integer">
   		delete from review where orderno = #{orderno}
   </delete>
   
   <select id="reviewlist" resultType="alireview" parameterType="String">
   		select * from review where rest_id = #{rest_id}
   </select>
   
   <select id="staravg" resultType="Integer" parameterType="String">
   		select avg(star) from review where rest_id = #{rest_id}
   </select>
   

   <!-- //review -->
    <!-- and  pw = #{ pw} -->
</mapper>
